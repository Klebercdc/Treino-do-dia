<!DOCTYPE html>
<html lang="pt">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        body { margin: 0; background: transparent; font-family: -apple-system, sans-serif; display: flex; justify-content: center; padding: 10px; }
        .timer-card { background: #ffffff; padding: 15px; border-radius: 20px; text-align: center; width: 100%; max-width: 280px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); border: 1px solid #eee; }
        #display { font-size: 42px; font-weight: 800; color: #3b5bdb; margin: 5px 0; font-family: monospace; }
        .controls { display: flex; gap: 5px; justify-content: center; margin-bottom: 12px; flex-wrap: wrap; }
        .btn-time { background: #f1f3f5; border: 1px solid #ddd; padding: 6px 10px; border-radius: 8px; font-weight: bold; font-size: 13px; cursor: pointer; }
        .btn-time.active { background: #3b5bdb; color: white; border-color: #3b5bdb; }
        .action-group { display: flex; gap: 8px; }
        .btn-action { flex: 1; padding: 12px; border-radius: 12px; border: none; font-weight: bold; text-transform: uppercase; cursor: pointer; font-size: 12px; }
        .btn-start { background: #40c057; color: white; }
        .btn-pause { background: #fd7e14; color: white; }
        .btn-reset { background: #868e96; color: white; }
    </style>
</head>
<body>

    <div class="timer-card">
        <div style="font-size: 11px; color: #868e96; font-weight: 800; letter-spacing: 1px;">DESCANSO</div>
        <div id="display">01:00</div>
        
        <div class="controls">
            <button class="btn-time active" onclick="setTime(60, this)">1m</button>
            <button class="btn-time" onclick="setTime(120, this)">2m</button>
            <button class="btn-time" onclick="setTime(180, this)">3m</button>
            <button class="btn-time" onclick="setTime(300, this)">5m</button>
        </div>

        <div class="action-group">
            <button class="btn-action btn-reset" onclick="resetTimer()">Zerar</button>
            <button id="mainBtn" class="btn-action btn-start" onclick="toggleTimer()">Iniciar</button>
        </div>
    </div>

    <script>
        let countdown;
        let timeLeft = 60;
        let baseTime = 60;
        let isRunning = false;
        const audioCtx = new (window.AudioContext || window.webkitAudioContext)();

        // Função para gerar o som de BIP
        function playBip(frequency = 880, duration = 0.2) {
            const oscillator = audioCtx.createOscillator();
            const gainNode = audioCtx.createGain();
            oscillator.type = "sine";
            oscillator.frequency.value = frequency;
            gainNode.gain.setValueAtTime(0.1, audioCtx.currentTime);
            oscillator.connect(gainNode);
            gainNode.connect(audioCtx.destination);
            oscillator.start();
            oscillator.stop(audioCtx.currentTime + duration);
        }

        function setTime(seconds, btn) {
            if(isRunning) return;
            baseTime = seconds;
            timeLeft = seconds;
            updateDisplay();
            document.querySelectorAll('.btn-time').forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
        }

        function updateDisplay() {
            let m = Math.floor(timeLeft / 60);
            let s = timeLeft % 60;
            document.getElementById('display').innerText = `${m}:${s < 10 ? '0' : ''}${s}`;
        }

        function toggleTimer() {
            if (audioCtx.state === 'suspended') audioCtx.resume();
            const btn = document.getElementById('mainBtn');
            if (isRunning) {
                clearInterval(countdown);
                isRunning = false;
                btn.innerText = "Continuar";
                btn.className = "btn-action btn-start";
            } else {
                isRunning = true;
                btn.innerText = "Pausar";
                btn.className = "btn-action btn-pause";
                countdown = setInterval(() => {
                    if(timeLeft > 0) {
                        timeLeft--;
                        updateDisplay();
                    } else {
                        finishTimer();
                    }
                }, 1000);
            }
        }

        function resetTimer() {
            clearInterval(countdown);
            isRunning = false;
            timeLeft = baseTime;
            updateDisplay();
            const btn = document.getElementById('mainBtn');
            btn.innerText = "Iniciar";
            btn.className = "btn-action btn-start";
        }

        function finishTimer() {
            clearInterval(countdown);
            isRunning = false;
            updateDisplay();
            const btn = document.getElementById('mainBtn');
            btn.innerText = "Iniciar";
            btn.className = "btn-action btn-start";
            
            // Toca o BIP 3 vezes
            playBip(880, 0.3);
            setTimeout(() => playBip(880, 0.3), 500);
            setTimeout(() => playBip(880, 0.3), 1000);

            if (navigator.vibrate) navigator.vibrate([200, 100, 200]);
            timeLeft = baseTime;
        }
    </script>
</body>
</html>
