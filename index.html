<!doctype html>
<html lang="pt-BR">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0" />
    <meta name="theme-color" content="#0b1220" />
    <title>TITAN LOG - Custom</title>
    <style>
      :root { --bg: #0b1220; --card: #161e2e; --blue: #3182ce; --text: #f7fafc; --orange: #f6ad55; --green: #38b2ac; --red: #e53e3e; }
      body { background: var(--bg); color: var(--text); font-family: -apple-system, sans-serif; margin: 0; padding-bottom: 60px; }
      .topbar { padding: 15px; display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid #2d3748; }
      .period-selector { background: var(--card); padding: 12px; border-bottom: 2px solid var(--blue); display: flex; align-items: center; justify-content: center; gap: 10px; }
      .period-selector select { background: #0b1220; color: var(--orange); border: 1px solid var(--orange); border-radius: 5px; padding: 8px; font-weight: bold; width: 65%; }
      .nav-pills { display: flex; gap: 8px; padding: 10px; background: var(--bg); position: sticky; top: 0; z-index: 10; }
      .pill { flex: 1; text-align: center; padding: 12px; border-radius: 8px; background: #1a202c; font-weight: bold; font-size: 0.8rem; border: 1px solid #2d3748; cursor: pointer; color: #a0aec0; }
      .pill.active { background: var(--blue); border-color: var(--blue); color: white; }
      .exercise-card { background: var(--card); border-radius: 12px; padding: 15px; margin: 10px; border: 1px solid #2d3748; }
      .ex-title { font-weight: 800; font-size: 1.1rem; color: var(--blue); }
      .ex-target { font-size: 0.9rem; color: var(--orange); font-weight: bold; margin: 4px 0; display: block; }
      .series-row { display: grid; grid-template-columns: 40px 1fr 1fr 1fr; gap: 8px; align-items: center; margin-bottom: 8px; }
      .input-box { background: #0b1220; border: 1px solid #2d3748; border-radius: 6px; padding: 8px 0; }
      .input-box input { background: transparent; border: none; color: #fff; width: 100%; text-align: center; font-size: 1.1rem; outline: none; font-weight: bold; }
      .section { display: none; }
      .section.active { display: block; }
      .btn { padding: 12px; border-radius: 8px; border: none; font-weight: bold; cursor: pointer; text-align: center; }
      .btn.primary { background: var(--green); color: #fff; width: 100%; }
      .btn.secondary { background: #2d3748; color: #fff; }
      
      dialog { background: #161e2e; color: #fff; border: 1px solid var(--blue); border-radius: 12px; width: 90%; max-width: 500px; padding: 20px; }
      .config-group { margin-bottom: 15px; border-bottom: 1px solid #2d3748; padding-bottom: 10px; }
      .config-item { display: flex; align-items: center; gap: 10px; margin: 5px 0; font-size: 0.9rem; }
    </style>
  </head>
  <body>
    <header class="topbar">
      <div><h1 style="margin:0; font-size: 1.2rem;">TITAN LOG</h1></div>
      <div style="display:flex; gap:5px;">
        <button class="btn secondary" style="padding: 8px;" id="btnConfig">‚öôÔ∏è Config</button>
        <button class="btn secondary" style="padding: 8px;" id="btnHistory">üìú Hist</button>
      </div>
    </header>

    <div class="period-selector">
      <select id="periodoFase" onchange="buildTreino()">
        <option value="hipertrofia">HIPERTROFIA (8-12 Reps)</option>
        <option value="forca">FOR√áA (5-8 Reps)</option>
        <option value="metabolico">METAB√ìLICO (15-20 Reps)</option>
        <option value="deload">DELOAD (Recupera√ß√£o)</option>
      </select>
    </div>

    <div class="nav-pills">
      <div class="pill active" id="pillA" onclick="tab('A')">TREINO A</div>
      <div class="pill" id="pillB" onclick="tab('B')">TREINO B</div>
      <div class="pill" id="pillC" onclick="tab('C')">TREINO C</div>
    </div>

    <main id="mainContainer">
      <div id="A" class="section active"></div>
      <div id="B" class="section"></div>
      <div id="C" class="section"></div>
    </main>

    <div style="padding: 10px; display: flex; gap: 10px;">
        <button class="btn secondary" id="btnCopy" style="flex:1">Copiar Whats</button>
        <button class="btn primary" id="btnSave" style="flex:2">SALVAR TREINO</button>
    </div>

    <dialog id="modalConfig">
        <h3 style="color:var(--blue)">Configurar Exerc√≠cios</h3>
        <p style="font-size:0.8rem">Selecione o Treino (A, B ou C) e marque os exerc√≠cios:</p>
        <select id="selectTreinoConfig" onchange="renderChecklist()" style="width:100%; padding:10px; margin-bottom:15px; background:#0b1220; color:white;">
            <option value="A">Editar Treino A</option>
            <option value="B">Editar Treino B</option>
            <option value="C">Editar Treino C</option>
        </select>
        <div id="checklistExercicios" style="max-height:300px; overflow-y:auto;"></div>
        <button class="btn primary" onclick="document.getElementById('modalConfig').close(); buildTreino();" style="margin-top:15px;">Salvar e Fechar</button>
    </dialog>

    <dialog id="modalHistory">
        <h3 style="color:var(--orange)">Hist√≥rico</h3>
        <div id="historyContent" style="max-height:350px; overflow-y:auto;"></div>
        <button class="btn secondary" onclick="document.getElementById('modalHistory').close()" style="width:100%; margin-top:10px;">Fechar</button>
    </dialog>

    <script>
      const biblioteca = {
        "PERNAS": ["Agachamento Livre", "Leg Press 45", "Cadeira Extensora", "Cadeira Flexora", "Stiff", "Afundo", "Eleva√ß√£o de Panturrilha"],
        "PEITO": ["Supino Reto", "Supino Inclinado", "Crucifixo", "Cross Over", "Flex√£o de Bra√ßo"],
        "COSTAS": ["Puxada Alta", "Remada Curvada", "Remada Baixa", "Pull Down", "Levantamento Terra"],
        "OMBROS": ["Desenvolvimento", "Eleva√ß√£o Lateral", "Eleva√ß√£o Frontal", "Face Pull"],
        "BRA√áOS": ["Rosca Direta", "Rosca Martelo", "Tr√≠ceps Corda", "Tr√≠ceps Testa", "Paralelas"]
      };

      // Carrega ou define padr√£o
      let meuTreino = JSON.parse(localStorage.getItem('titan_setup')) || {
        A: ["Agachamento Livre", "Supino Inclinado", "Desenvolvimento"],
        B: ["Levantamento Terra", "Remada Curvada", "Puxada Alta"],
        C: ["Leg Press 45", "Eleva√ß√£o Lateral", "Tr√≠ceps Corda"]
      };

      const fases = {
        hipertrofia: { reps: "8-12", rpe: "8-9", s: 4 },
        forca: { reps: "5-8", rpe: "9-10", s: 4 },
        metabolico: { reps: "15-20", rpe: "10", s: 3 },
        deload: { reps: "10-12", rpe: "6", s: 2 }
      };

      function tab(id) {
        document.querySelectorAll('.section, .pill').forEach(el => el.classList.remove('active'));
        document.getElementById(id).classList.add('active');
        document.getElementById('pill'+id).classList.add('active');
      }

      function buildTreino() {
        const fase = document.getElementById('periodoFase').value;
        const conf = fases[fase];
        ['A', 'B', 'C'].forEach(id => {
          const container = document.getElementById(id);
          container.innerHTML = "";
          meuTreino[id].forEach(ex => {
            let html = `<div class="exercise-card"><div class="ex-title">${ex}</div><div class="ex-target">META: ${conf.reps} REPS | RPE ${conf.rpe}</div><div style="display:grid; grid-template-columns: 40px 1fr 1fr 1fr; gap:8px; text-align:center; font-size:0.6rem; color:#718096; margin-bottom:5px;"><span>S√âRIE</span><span>KG</span><span>REPS</span><span>RPE</span></div>`;
            for (let i = 1; i <= conf.s; i++) {
              html += `<div class="series-row"><div style="text-align:center; font-weight:bold; color:#718096;">S${i}</div><div class="input-box"><input type="number" inputmode="decimal"></div><div class="input-box"><input type="number" inputmode="numeric"></div><div class="input-box"><input type="number" inputmode="numeric"></div></div>`;
            }
            container.innerHTML += html + `</div>`;
          });
        });
      }

      function renderChecklist() {
        const treino = document.getElementById('selectTreinoConfig').value;
        const container = document.getElementById('checklistExercicios');
        container.innerHTML = "";
        for (let cat in biblioteca) {
          let html = `<div class="config-group"><strong>${cat}</strong>`;
          biblioteca[cat].forEach(ex => {
            const checked = meuTreino[treino].includes(ex) ? 'checked' : '';
            html += `<div class="config-item"><input type="checkbox" value="${ex}" ${checked} onchange="updateSetup('${treino}', this)"> ${ex}</div>`;
          });
          container.innerHTML += html + `</div>`;
        }
      }

      function updateSetup(treino, el) {
        if (el.checked) { meuTreino[treino].push(el.value); }
        else { meuTreino[treino] = meuTreino[treino].filter(i => i !== el.value); }
        localStorage.setItem('titan_setup', JSON.stringify(meuTreino));
      }

      // SALVAR E HIST√ìRICO
      document.getElementById('btnSave').onclick = () => {
          const tAtivo = document.querySelector('.section.active').id;
          const logs = [];
          document.querySelectorAll(`#${tAtivo} .exercise-card`).forEach(card => {
              const nome = card.querySelector('.ex-title').innerText;
              card.querySelectorAll('.series-row').forEach((l, i) => {
                  const inp = l.querySelectorAll('input');
                  if (inp[1].value) logs.push({ ex: nome, s: i+1, kg: inp[0].value||0, reps: inp[1].value, rpe: inp[2].value||'-' });
              });
          });
          if (!logs.length) return alert("Preencha algo!");
          let hist = JSON.parse(localStorage.getItem('titan_log') || '[]');
          hist.unshift({ data: new Date().toLocaleString('pt-BR'), treino: tAtivo, dados: logs });
          localStorage.setItem('titan_log', JSON.stringify(hist.slice(0, 20)));
          alert("‚úÖ Salvo!");
      };

      document.getElementById('btnHistory').onclick = () => {
          const hist = JSON.parse(localStorage.getItem('titan_log') || '[]');
          document.getElementById('historyContent').innerHTML = hist.map(h => `<div style="border-bottom:1px solid #2d3748; padding:10px 0;"><strong style="color:var(--orange)">${h.data} (${h.treino})</strong>${h.dados.map(d => `<div style="font-size:0.75rem;">${d.ex} S${d.s}: ${d.kg}kg x ${d.reps}</div>`).join('')}</div>`).join('') || "Vazio";
          document.getElementById('modalHistory').showModal();
      };

      document.getElementById('btnConfig').onclick = () => { renderChecklist(); document.getElementById('modalConfig').showModal(); };
      
      window.onload = buildTreino;
    </script>
  </body>
</html>
